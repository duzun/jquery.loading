{"version":3,"file":"loading.js","sources":["loading.esm.js"],"sourcesContent":["/**\n * A jQuery plugin to add/remove classes to a collection while a promise is pending or something is loading asynchronously.\n *\n * @license MIT\n * @author Dumitru Uzun (DUzun.Me)\n * @version 1.2.1\n */\nexport default function initLoading($) {\n    const lck = '_loading_class_';\n    const lcd = lck + 'disabled_';\n    const prp = 'disabled';\n    /**\n     * Adds/Removes loading class on the collection.\n     *\n     * Usage:\n     *   1)\n     *       $('selector').loading('loading'); // add class\n     *       ...\n     *       $('selector').loading(false); // remove added loading class\n     *\n     *   2)\n     *       const done = $('selector').loading('loading', true); // add class and get the callback\n     *       ...\n     *       done(); // remove added loading class\n     *\n     *   3)\n     *       $('selector').loading('loading', promise); // add class and remove on promise resolve or reject\n     *\n     *   4)\n     *       const done = $('selector').loading('loading', promise); // add class and remove on promise resolve or reject\n     *       setTimeout(done, 5e3); // timeout if promise takes too long\n     *\n     * @param {String|Array} classes  - classes to be added to collection while loading\n     * @param {Boolean|Promise} retCb - if true, return a done() function to be called when done loading\n     *                                - if a promise, remove classes on resolve or reject\n     *\n     * @return {jQuery|Function} - by default (no retCb) it returns the jQuery collection (this),\n     *                             but if retCb not falsy, done() function returned\n     */\n    const loading = function loading(classes, retCb = undefined) {\n        const that = this;\n        if (classes === false) {\n            that.each(function (i, e) {\n                e = $(e);\n                i = e.data(lck);\n                if (i) {\n                    e.removeClass(i).data(lck, undefined);\n                }\n                i = e.data(lcd);\n                if (i) {\n                    e.attr(i, null).prop(i, false).data(lcd, undefined);\n                }\n            });\n        }\n        else {\n            if (retCb) {\n                that.addClass(classes).attr(prp, prp).prop(prp, true);\n                let done = function (a) {\n                    // Prevent calling it more then once\n                    if (done) {\n                        that.removeClass(classes).attr(prp, null).prop(prp, false);\n                        done = undefined;\n                    }\n                    return arguments.length == 1 ? a : that; // in Promises return the result without altering it\n                };\n                // If retCb is a promise, call done() on resolve and reject\n                if (retCb !== true && $.isFunction(retCb.then)) {\n                    retCb.then(done, done);\n                }\n                return done;\n            }\n            that.each(function (i, e) {\n                e = $(e);\n                i = e.data(lck);\n                e.data(lck, (i ? i + ' ' : '') + classes);\n                if (!e.prop(prp)) {\n                    e.attr(prp, prp).prop(prp, true).data(lcd, prp);\n                }\n            })\n                .addClass(classes);\n        }\n        return that;\n    };\n    $.fn.loading = loading;\n    return loading;\n}\n// Auto-init in browser when jQuery or Zepto is present\nif (typeof window !== 'undefined') {\n    const $ = window.jQuery || window.Zepto;\n    if ($) {\n        initLoading($);\n    }\n}\n"],"names":["initLoading","$","lck","lcd","prp","loading","classes","retCb","undefined","that","each","i","e","data","removeClass","attr","prop","addClass","done","a","arguments","length","isFunction","then","fn","window","jQuery","Zepto"],"mappings":"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"}
{"version":3,"file":"loading.js","sources":["../loading.js"],"sourcesContent":["/**\n * A jQuery plugin to add/remove classes to a collection while a promise is pending or something is loading asynchronously.\n *\n * @license MIT\n * @author Dumitru Uzun (DUzun.Me)\n * @version 1.2.0\n */\n// ---------------------------------------------------------------------------\nexport default function initLoading($) {\n\n        /**\n         * Adds/Removes loading class on the collection.\n         *\n         * Eg:\n         *   1)\n         *       $('selector').loading('loading'); // add class\n         *       ...\n         *       $('selector').loading(false); // remove added loading class\n         *   2)\n         *       var cb = $('selector').loading('loading', true); // add class and get the callback\n         *       ...\n         *       cb(); // remove added loading class\n         *   3)\n         *       $('selector').loading('loading', promise); // add class and remove on promise resolve or reject\n         *\n         * @param {String|Array} classes - classes to be added to collection while loading\n         * @param {Boolean|Promise} retCb - if true, return a done() function to be called when done loading\n         *                           - if a promise, remove classes on resolve or reject\n         *\n         * @return {jQuery|Function} - by default (no retCb) it returns the jQuery collection (this),\n         *                           but if retCb not falsy, done() function returned\n         */\n        function loading(classes, retCb) {\n            var lck = '_loading_class_';\n            var lcd = lck + 'disabled_';\n            var prp = 'disabled';\n            var that = this;\n            if ( classes === false ) {\n                that.each(function (i,e) {\n                    e = $(e);\n                    i = e.data(lck);\n                    if ( i ) {\n                        e.removeClass(i).data(lck, undefined);\n                    }\n                    i = e.data(lcd);\n                    if ( i ) {\n                        e.attr(i, null).prop(i, false).data(lcd, undefined);\n                    }\n                });\n            }\n            else {\n                if ( retCb ) {\n                    that.addClass(classes).attr(prp, prp).prop(prp, true);\n                    var done = function (a) {\n                        // Prevent calling it more then once\n                        if ( done ) {\n                            that.removeClass(classes).attr(prp, null).prop(prp, false);\n                            done = undefined;\n                        }\n                        return arguments.length == 1 ? a : that; // in Promises return the result without altering it\n                    };\n                    // If retCb is a promise, call done() on resolve and reject\n                    if ( $.isFunction(retCb.then) ) {\n                        retCb.then(done, done);\n                    }\n                    return done;\n                }\n                that.each(function (i,e) {\n                    e = $(e);\n                    i = e.data(lck);\n                    e.data(lck, (i?i+' ':'')+classes);\n                    if ( !e.prop(prp) ) {\n                        e.attr(prp, prp).prop(prp, true).data(lcd, prp);\n                    }\n                })\n                .addClass(classes);\n            }\n            return that;\n        }\n\n    $.fn.loading = loading;\n\n    return loading;\n}\n\n// Auto-init in browser when jQuery or Zepto is present\nif ( typeof window !== 'undefined' ) {\n    const $ = window.jQuery || window.Zepto;\n    if ( $ ) initLoading($);\n}\n"],"names":["initLoading","$","loading","classes","retCb","lck","lcd","prp","that","each","i","e","data","removeClass","undefined","attr","prop","addClass","done","a","arguments","length","isFunction","then","fn","window","jQuery","Zepto"],"mappings":"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"}